function refresh(e,n){function t(){console.log("Connecting to notifications...");var e=new EventSource("/notifications");e.onmessage=function(e){a(JSON.parse(e.data))},e.onerror=function(e){console.log("... error on notifications",e)},e.onopen=function(){console.log("... notifications ok!")}}var o=e,a=function(e){e.walkIndex==o.walkIndex&&e.paused==o.paused||n(e,function(){o=e})},i=function(){console.log("Master lost..."),splashReconnect()};t();var r=function(){jQuery.ajax({method:"GET",url:"/state",success:function(e){a(e),setTimeout(r,2500)},error:i})};setTimeout(r,2500)}function refreshDisplay(e,n){var t=function(e){jQuery("main").html(e),n()},o=function(){n()};jQuery.ajax({method:"GET",url:window.location,headers:{Accept:"application/vnd.easycast.display+html"},success:t,error:o})}function refreshRemote(e,n){jQuery("main.remote > ul li.active").removeClass("active"),jQuery("main.remote > ul li.node-"+e.walkIndex).addClass("active");var t=jQuery("main.remote > ul li.active").offset(),o=window.innerHeight;jQuery("html, body").animate({scrollTop:t.top-o/3,scrollLeft:t.left}),e.paused?(jQuery("#scheduler_icon").addClass("fa-play"),jQuery("#scheduler_icon").removeClass("fa-pause")):(jQuery("#scheduler_icon").removeClass("fa-play"),jQuery("#scheduler_icon").addClass("fa-pause")),n()}function refreshDoors(e,n){jQuery("main.doors ul li.active").removeClass("active"),jQuery("main.doors ul li.node-"+e.doorIndex).addClass("active"),n()}function installGallery(e,n,t){function o(a){var i=jQuery("#"+e+" img");i.length>0&&(i[0].src=n[a],setTimeout(function(){o((a+1)%n.length)},t))}o(0)}function splashWait(e){var n=new XMLHttpRequest;n.onreadystatechange=function(){4==this.readyState&&200==this.status?window.location=e:4==this.readyState&&setTimeout(function(){splashWait(e)},2500)},console.log("Trying to reach master at "+e),n.open("GET",e,!0),n.send()}function splashConnect(){function e(){window.location=window.location}const n=window.location.search,t=new URLSearchParams(n),o=decodeURIComponent(t.get("target")||"http://easycast/");setTimeout(e,15e3),setTimeout(function(){splashWait(o)},1500)}function splashReconnect(){jQuery("aside.splash").show(),splashWait(window.location)}function showQRCodes(){var e="WIFI:S:easycast;T:WEP;P:easypass;H:false;;",n="http://easycast/remote",t=Math.max(e.length,n.length);e=e.padEnd(length),n=n.padEnd(t),new QRious({element:document.getElementById("qr-network"),value:e,size:200}),new QRious({element:document.getElementById("qr-remote"),value:n,size:200})}jQuery(function(){function e(e){e.preventDefault(),e.stopPropagation();var n=o.find("ul li.active").offset(),t=window.innerHeight;o.css({left:0}),o.addClass("open"),o.animate({scrollTop:n.top-t/2,scrollLeft:n.left})}function n(e){e.preventDefault(),e.stopPropagation(),o.css({left:-350}),o.removeClass("open")}function t(){document.getElementById("menu")&&(o=jQuery("#menu"),jQuery(".open-menu-btn").click(e),jQuery(".close-menu-btn").click(n),jQuery("body").click(n))}var o=null;t()}),jQuery(function(){jQuery("#cogs-toggle").click(function(){jQuery("main.remote > ul.prev-next").hide(),jQuery("main.remote > ul.cogs").show()}),jQuery("#cogs-back").click(function(){jQuery("main.remote > ul.prev-next").show(),jQuery("main.remote > ul.cogs").hide()}),jQuery("main.remote > ul > li a").click(function(e){var n=jQuery(this).attr("href");if(n){jQuery(this).data("confirm")&&!confirm("Etes-vous s\xfbr.e?")||(e.preventDefault(),e.stopPropagation(),$.ajax({url:n,method:"POST",data:{}}))}return!1})}),jQuery(function(){jQuery("main.doors ul > li").click(function(e){var n=jQuery(jQuery(this).find("a")).attr("href");return n&&(e.preventDefault(),e.stopPropagation(),$.ajax({url:n,method:"POST",data:{}})),!1})}),jQuery(function(){function e(){window.location=window.location}0!=jQuery("body.error").length&&setTimeout(e,2500)});