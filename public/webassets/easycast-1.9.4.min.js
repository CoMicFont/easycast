function refresh(e,t){function n(){console.log("Connecting to notifications...");var e=new EventSource("/notifications");e.onmessage=function(e){i(JSON.parse(e.data))},e.onerror=function(e){console.log("... error on notifications",e)},e.onopen=function(){console.log("... notifications ok!")}}var o=e,a=0,i=function(e,n){if("state"===e.type){var a=e.detail;(n||a.walkIndex!=o.walkIndex||a.paused!=o.paused)&&t(a,function(){o=a})}else if("video"===e.type){var i=document.getElementsByTagName("video")[0];if(i)switch(e.detail.command){case"play":i.play();break;case"pause":i.pause();break;case"backward":i.currentTime=i.currentTime-3;break;case"forward":i.currentTime=i.currentTime+3}}},s=function(e){return function(t){a=0,i({type:"state",detail:t},e),setTimeout(c,2500)}},r=function(){return function(){console.log("Master lost..."),a+=1,a>8?splashReconnect():setTimeout(c,1e3)}};n();var c=function(e){jQuery.ajax({method:"GET",url:"/state",success:s(e),error:r(e)})};c(!0)}function refreshDisplay(e,t){var n=function(e){jQuery("main").replaceWith(e),t()},o=function(){t()};jQuery.ajax({method:"GET",url:window.location,headers:{Accept:"application/vnd.easycast.display+html"},success:n,error:o})}function refreshRemote(e,t){jQuery("main.remote > ul li.active").removeClass("active"),jQuery("main.remote > ul li.node-"+e.walkIndex).addClass("active"),jQuery("main.remote > ul li.node-"+e.walkIndex).parent().parent().addClass("collapsed");var n=jQuery("main.remote > ul li.active").offset(),o=window.innerHeight;jQuery("html, body").animate({scrollTop:n.top-o/3,scrollLeft:n.left}),e.paused?(jQuery("#scheduler_icon").addClass("fa-play"),jQuery("#scheduler_icon").removeClass("fa-pause")):(jQuery("#scheduler_icon").removeClass("fa-play"),jQuery("#scheduler_icon").addClass("fa-pause")),t()}function refreshSwitcher(e,t){var n=function(e){jQuery("main").replaceWith(e),installButtonList(),t()},o=function(){t()};jQuery.ajax({method:"GET",url:window.location,headers:{Accept:"application/vnd.easycast.display+html"},success:n,error:o})}function refreshDoors(e,t){jQuery("main.doors ul li.active").removeClass("active"),jQuery("main.doors ul li.node-"+e.doorIndex).addClass("active"),t()}function installGallery(e,t,n){function o(a){var i=jQuery("#"+e+" img");i.length>0&&(i[0].src=t[a],setTimeout(function(){o((a+1)%t.length)},n))}o(0)}function splashWait(e){var t=new XMLHttpRequest;t.onreadystatechange=function(){4==this.readyState&&200==this.status?window.location=e:4==this.readyState&&setTimeout(function(){splashWait(e)},1e3)},console.log("Trying to reach master at "+e),t.open("GET",e,!0),t.send()}function splashConnect(){function e(){window.location=window.location}const t=window.location.search,n=new URLSearchParams(t),o=decodeURIComponent(n.get("target")||"http://easycast/");setTimeout(e,15e3),setTimeout(function(){splashWait(o)},500)}function splashReconnect(){jQuery("aside.splash").show(),splashWait(window.location)}function showQRCodes(){var e="WIFI:S:easycast;T:WEP;P:easypass;H:false;;",t="http://easycast-master/remote",n=Math.max(e.length,t.length);e=e.padEnd(length),t=t.padEnd(n),new QRious({element:document.getElementById("qr-network"),value:e,size:200}),new QRious({element:document.getElementById("qr-remote"),value:t,size:200})}function installButtonList(){jQuery("ul.button-list li.dynamic > a").click(function(e){var t=jQuery(this).attr("href"),n=jQuery(this).data("redirect");if(t){jQuery(this).data("confirm")&&!confirm("Etes-vous s\xfbr.e?")||(e.preventDefault(),e.stopPropagation(),$.ajax({url:t,method:"POST",data:{},success:function(){n&&(window.location=window.location.toString().replace("/switcher",n))}}))}return!1}),jQuery("ul.button-list li.collapsable").click(function(){return $(this).toggleClass("collapsed"),!1})}jQuery(function(){function e(e){e.preventDefault(),e.stopPropagation();var t=o.find("ul li.active").offset(),n=window.innerHeight;o.css({left:0}),o.addClass("open"),o.animate({scrollTop:t.top-n/2,scrollLeft:t.left})}function t(e){e.preventDefault(),e.stopPropagation(),o.css({left:-350}),o.removeClass("open")}function n(){document.getElementById("menu")&&(o=jQuery("#menu"),jQuery(".open-menu-btn").click(e),jQuery(".close-menu-btn").click(t),jQuery("body").click(t))}var o=null;n()}),jQuery(function(){jQuery("main.doors ul > li").click(function(e){var t=jQuery(jQuery(this).find("a")).attr("href");return t&&(e.preventDefault(),e.stopPropagation(),$.ajax({url:t,method:"POST",data:{}})),!1})}),jQuery(function(){function e(){window.location=window.location}0!=jQuery("body.error").length&&setTimeout(e,2500)}),jQuery(installButtonList);